[package]
name = "opencode-cloud-core"
version = "3.2.0"
edition = "2024"
rust-version = "1.88"
license = "MIT"
repository = "https://github.com/pRizz/opencode-cloud"
homepage = "https://github.com/pRizz/opencode-cloud"
documentation = "https://docs.rs/opencode-cloud"
keywords = ["opencode", "ai", "cloud", "docker", "cli"]
categories = ["command-line-utilities", "development-tools"]
description = "Core library for opencode-cloud - config management, singleton enforcement, and shared utilities"
readme = "README.md"
exclude = ["*.node", "index.js", "index.d.ts"]

[lib]
# Both crate types: cdylib for NAPI Node bindings, rlib for Rust CLI
crate-type = ["cdylib", "rlib"]

[features]
default = []
napi = ["dep:napi", "dep:napi-derive"]

[dependencies]
clap = { version = "4.5", features = ["derive"] }
tokio = { version = "1.43", features = ["rt-multi-thread", "macros"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
jsonc-parser = { version = "0.29", features = ["serde"] }
directories = "5"
thiserror = "2"
anyhow = "1"
tracing = "0.1"
console = "0.16"
chrono = { version = "0.4", default-features = false, features = ["std", "clock"] }

# NAPI dependencies (optional - only for Node bindings)
napi = { version = "2", features = ["tokio_rt", "napi9"], optional = true }
napi-derive = { version = "2", optional = true }

# Docker integration
bollard = { version = "0.18", features = ["chrono", "buildkit"] }
futures-util = "0.3"
tar = "0.4"
flate2 = "1.0"
tokio-retry = "0.3"
indicatif = { version = "0.17", features = ["tokio", "futures"] }
http-body-util = "0.1"
bytes = "1.9"
reqwest = { version = "0.12", default-features = false, features = ["rustls-tls", "json"] }

# Platform service management (macOS)
plist = "1.8"

# Host management
whoami = "1.5"
ssh2-config-rs = "0.7.2"
dirs = "6"

[build-dependencies]
napi-build = "2"

[dev-dependencies]
tempfile = "3"
